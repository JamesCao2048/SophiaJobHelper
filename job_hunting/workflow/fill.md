# Fill - 填充 Excel 信息

## 目标
通过网络爬取分析，验证并填充 `china_job_list_{date}.xlsx` 中各列的缺失信息。

## 前置条件
- `setup` 任务已完成
- 网络连接正常

## 执行步骤

### 1. 读取 Excel 文件
```python
import pandas as pd
df = pd.read_excel('china_job_list.xlsx')
```

### 2. 遍历每一行，填充缺失信息

对于每一行（每个学校/岗位），检查以下字段的有效性，并进行填充:

#### 2.1 Deadline（截止日期）
- **来源**: 岗位详情页面、学校人事处公告
- **搜索关键词**: "{学校名} 教职招聘 截止日期"、"申请截止"、"报名时间"
- **格式转换**:
  - "2026年3月1日" → "2026-03-01"
  - "长期招聘"/"常年有效" → "Rolling"
- **优先级**: 页面明确日期 > 推测日期 > Rolling

#### 2.2 Position Title（岗位标题）
- **来源**: 岗位详情页面
- **示例**: "计算机学院-人工智能方向助理教授"
- **注意**: 提取准确的职位名称，包含方向说明

#### 2.3 Position Research Direction (AI/HCI/HAI)
- **来源**: 岗位描述、研究方向说明
- **分类**:
  - `AI`: 人工智能、机器学习、深度学习
  - `HCI`: 人机交互、交互设计、用户体验
  - `HAI`: 以人为中心的AI、人机协作
- **可多选**: 如 "AI/HCI"

#### 2.4 Job Description（岗位描述）
- **来源**: 岗位详情页面
- **重点抓取**:
  - 博导资格要求
  - 博士生招生名额（越多越好）
  - 职责描述
  - 薪酬福利
  - 科研启动经费
  - 住房/安家费

#### 2.5 Lab/Research Center/Professor Link
- **来源**: 学校官网, CS Ranking （HCI, AI）
- **内容**: 相关实验室、研究中心或知名教授的主页链接
- **搜索**: "{学校名} {学院} 人机交互/人工智能实验室"、"HCI 教授"
- **重点关注**: 人机交互实验室、人机协作实验室、人机交互/人工智能研究中心

#### 2.6 OverseaPolicy（海外政策）
- **来源**: 人事处、人才引进页面
- **关键词搜索**:
  - "海外优青"
  - "海外引进人才"
  - "百人计划"
  - "青年千人"
  - 省/市级海外人才计划
- **记录**: 政策名称 + 简要待遇说明

#### 2.7 联系方式 & 联系方式的链接
- **重点**: 微信联系方式
- **其他**: 邮箱、电话
- **来源链接**: 保存联系信息所在页面的 URL

### 3. 保存更新后的文件
```python
# 备份
df_original = pd.read_excel('china_job_list.xlsx')
df_original.to_excel(f'backups/backup_{timestamp}.xlsx', index=False)

# 保存更新
df.to_excel('china_job_list.xlsx', index=False)
```

## 输入
- `china_job_list_{date}.xlsx`（已通过 setup 验证）
- 网络资源（学校官网、招聘页面）

## 输出
- 更新后的 `china_job_list_{date}_filled.xlsx`
- 备份文件

## 质量检查
- [ ] Deadline 格式正确（YYYY-MM-DD 或 Rolling）
- [ ] Position Title 非空且有意义
- [ ] Job Description 包含博导资格、招生名额信息
- [ ] 海外政策已记录（如有）
- [ ] 联系方式要完整，包括电话，邮箱，微信，重点记录微信
- [ ] 所有 URL 字段为有效链接，不能出现404

## 注意事项
- 不要修改 `是否计划申请` 列（人工维护）
- 中文日期需转换为标准格式
- 如页面无法访问，记录在 Notes 中
- 爬取时注意请求频率，避免被封禁
- 保留原始信息来源的 URL 以备查证
