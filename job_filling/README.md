# job_filling — AI 智能表单填写工具

> **目标**：学术教职申请表单从手动逐字填写，变为 AI 自动填写初稿 + 你快速校对，平均每份表单节省 20-40 分钟

---

## 目录

1. [工具是什么](#工具是什么)
2. [整体工作流程](#整体工作流程)
3. [第一次使用：安装与配置](#第一次使用安装与配置)
4. [每次使用：填写步骤](#每次使用填写步骤)
5. [如何给出调整意见](#如何给出调整意见)
6. [profile.yaml 说明](#profileyaml-说明)
7. [文件目录结构](#文件目录结构)
8. [常见问题](#常见问题)

---

## 工具是什么

这是一个让 Claude Code（AI 助手）自动填写学术教职申请网页表单的工具。

**核心原理**：Claude Code 读取你的个人资料（`profile.yaml`）和申请材料（`materials/`），通过 Chrome 远程调试接口连接你的浏览器，逐字段推理并填写网页表单。你只需检查并修正填写结果，无需手动逐字输入。

**主要特点**：
- **越用越准**：每次你修正 AI 填错的内容，系统自动记忆，下次申请同类字段时直接用修正后的值
- **支持复杂控件**：不仅支持普通文本框，也支持自定义 JS 下拉（如 PageUp 系统的 `pu-select`）、搜索弹窗等
- **安全不乱填**：对于没有信息依据的字段，AI 会明确告知你，而不是猜测乱填

---

## 整体工作流程

```
启动调试 https://申请页面URL    ← 一句话完成依赖安装+浏览器启动+导航
         ↓
在调试浏览器里登录，导航到表单第一页
         ↓
告诉 Claude Code："启动持续填写"
         ↓
AI 自动填写当前页 → 输出填写报告（✓/⚠/✗）
         ↓
你在调试浏览器中检查、修正 ⚠ 字段，补填 ✗ 字段
         ↓
直接点击"下一页"（无需告知 AI）
         ↓
AI 自动检测翻页 → 学习你的修改 → 填写新页面 → 输出报告
         ↓
重复，直到表单完成 → 告诉 AI "停"
```

**你主动操作的只有两件事**：检查报告 + 在调试浏览器里手动修正/翻页。其余全部由 AI 自动处理。


## 每次使用：填写步骤

**必须在 `job_filling/` 目录内启动 Claude Code：**

```bash
cd job_filling
claude --dangerously-skip-permissions
```

> **注意**：`--dangerously-skip-permissions` 让 AI 直接操作文件和运行脚本，无需逐一确认。这是正常使用所需的参数，在本地环境中安全。

启动后，Claude Code 会检查调试浏览器状态并告诉你下一步。

---

### Step 0：启动调试浏览器并打开申请页面

**说：**
```
启动调试 https://申请网站/表单页面URL
```

AI 会依次完成：
1. 检查并安装依赖（首次使用自动安装）
2. 启动**调试浏览器**（独立于你日常使用的 Chrome 的专用窗口）
3. 在调试浏览器中打开你提供的 URL

> **关于调试浏览器**：这是一个专用 Chrome 窗口（存储在 `/tmp/chrome-job-filling`），与你平时用的 Chrome 完全独立。首次使用时需要在这个窗口里重新登录申请网站，之后密码会自动保存，下次无需重复登录。**所有后续操作（检查填写结果、手动修正、点击下一页）都在这个调试浏览器中进行**，不要在你的日常 Chrome 中操作。

如果页面需要登录，在调试浏览器中完成登录并导航到表单页面，然后回来告诉 AI。

---

### Step 1：启动持续填写

**说（任选其一）：**
```
启动持续填写
开始填写
持续填写
```

AI 会立即填写当前页面并输出汇总报告：

```
📋 本轮填写汇总（共 12 个字段）

已填写（10 个）：
  ✓ 姓名 → Sophia Zhang
  ✓ 邮箱 → sophia@university.edu
  ⚠ 研究方向 → Human-Computer Interaction    ← 建议检查：从材料拼凑，不确定是否符合该系偏好

未填写（2 个）：
  ✗ 第二国籍 — profile 中无此信息
  ✗ 紧急联系人 — profile 中无此信息

🔍 建议重点检查：
  - 研究方向：选项较多，AI 选了最接近的，请确认是否准确

等待翻页中...（请在调试浏览器检查后点击"下一页"）
```

**信心标记含义：**
| 标记 | 含义 |
|------|------|
| ✓ | 高信心：来自记忆或 profile 精确匹配 |
| ⚠ | 低信心：通过推理得出，建议检查 |
| ✗ | 未填：确实无相关信息，需手动填写 |

---

### Step 2：在调试浏览器里校对并翻页

重点检查报告中 ⚠ 字段，手动补填 ✗ 字段。

**直接点击"下一页"**——无需告知 AI。AI 会自动检测到翻页，学习你的修改，并填写新页面。

---

### Step 3：重复，直到完成

AI 自动循环：检测翻页 → 学习修改 → 填写新页 → 输出报告 → 等待翻页…

完成所有页面后，告诉 AI：
```
停
结束
完成了
```

---

### 调试模式（排查问题时使用）

如果某页填写结果不对，或者只想处理当前页，可以用单页模式：

**填写当前页（不启动持续监控）：**
```
帮我填写表单
填写当前页
```

**手动告知翻页（触发学习 + 填写下一页）：**
```
下一页了
继续
```

单页模式下，每次翻页都需要手动告知 AI，适合逐页排查问题。

---

## 如何给出调整意见

### 方式一：直接口述

在 Claude Code 聊天窗口里描述你想要的修改：

```
第3个字段选的不对，这里应该选"Permanent Resident"不是"Citizen"
```

```
research interests 那段太短了，能不能更具体一点？
```

### 方式二：直接在 Chrome 里改 （推荐）

在表单页面直接手动修改字段，AI 翻页时会自动学习你的修改，下次同类字段会用新值。

---

## profile.yaml 说明

`profile.yaml` 是这个工具的核心数据文件，包含两部分：

### 基本信息（你手动维护）

```yaml
personal:           # 姓名、邮箱、电话、网站、ORCID
address:            # 通讯地址
current_position:   # 当前职位与机构
education:          # 教育经历列表
work_experience:    # 工作经历列表
references:         # 推荐人信息
research_interests: # 研究方向（primary/secondary/tertiary）
honors:             # 荣誉奖项
```

### 学习记忆（AI 自动维护）

```yaml
learned_fields:
  title:
    value: "Dr"               # 自动填写的值
    label: "Title:*"          # 该字段原始标签
  second_nationality:
    value: ""                 # 空字符串 = 刻意留空，下次跳过
    label: "Second nationality:"
```

`learned_fields` 是 AI 通过学习积累的记忆，**优先级最高**，匹配时会优先使用。字段越多，填写越准确。

> **安全说明**：`profile.yaml` 含个人敏感信息，已加入 `.gitignore`，不会提交到 git。`materials/` 目录同样如此。

---

## 文件目录结构

```
job_filling/
├── README.md                    ← 本文件
├── CLAUDE.md                    ← AI 指令（不需要手动修改）
├── form_filler.py               ← CLI 主入口
├── field_extractor.py           ← 从 DOM 提取表单字段
├── browser.py                  ← Playwright CDP 连接封装
├── profile_store.py             ← profile.yaml 读写工具
├── llm_matcher_local.py         ← 本地规则匹配（fallback）
├── pdf_to_md.py                 ← PDF → Markdown 转换工具
├── profile.yaml                 ← ★ 个人资料 + 学习记忆（本地保留，不提交）
└── materials/                   ← ★ 申请材料（本地保留，不提交）
    ├── CV.md
    ├── Research_Statement.md
    └── Teaching_Statement.md
```

---

## 常见问题

**Q: 第一次怎么开始？**

A: 启动 Claude Code 后，直接告诉 AI：`启动调试 https://申请网站URL`。AI 会自动：① 安装依赖；② 打开调试浏览器；③ 导航到你提供的 URL。不需要手动安装任何东西。

---

**Q: 调试浏览器和我平时用的 Chrome 是什么关系？**

A: 完全独立的两个 Chrome 窗口。调试浏览器使用单独的配置文件（存储在 `/tmp/chrome-job-filling`），有独立的 Cookie、密码保存、书签等。你在调试浏览器里登录的账号不会影响日常 Chrome，反之亦然。

首次使用需要在调试浏览器里登录申请网站，之后密码会保存，只需登录一次（除非你清除了 `/tmp/chrome-job-filling`）。

**重要：填写表单期间，所有操作（检查填写、手动修正、点击下一页）都在调试浏览器中进行，不要用日常 Chrome。**

---

**Q: AI 填错了怎么办？**

A: 直接在 Chrome 里手动改成正确值，然后点"下一页"。AI 会自动学习你的修改，下次不会再填错同类字段。如果是系统性错误（比如某类字段 AI 总是选错选项），可以告诉 AI："这类字段以后选 XX"，AI 会更新 `learned_fields`。

---

**Q: 有些字段是下拉选项，AI 能识别吗？**

A: 能。系统支持四种字段类型：

| 类型 | 说明 |
|------|------|
| 文本框 / 文本域 | 直接输入文本 |
| 原生下拉 `<select>` | 从选项列表中选择 |
| 单选 / 复选框 | 从选项值中选择 |
| 自定义 JS 下拉（如 PageUp pu-select） | 点击展开后选择 |
| 搜索弹窗（机构/专业查找） | 输入关键词后从搜索结果选择 |

---

**Q: 表单有"下一步"按钮触发新字段展开，AI 会处理吗？**

A: 会。某些表单在选择某个选项后（如"教育类型"）会动态展开子字段。AI 每次填写后会重新检查页面，发现新字段后继续匹配填写，循环直到没有新字段为止。

---

**Q: `profile.yaml` 填多详细比较好？**

A: 越详细越好。基本信息（姓名、地址、教育、工作经历、推荐人）填完整后，首次使用 AI 就能覆盖大部分字段。随着使用次数增加，`learned_fields` 会自动补全剩余细节。

---

**Q: 这个工具和 `overseas_pipeline` 是什么关系？**

A: 互补关系。`overseas_pipeline` 负责**准备**申请材料（Cover Letter、Research Statement 等），`job_filling` 负责**提交**申请（填写网页表单）。通常的完整流程是：先用 `overseas_pipeline` 生成定制化材料，再用 `job_filling` 填写学校的在线申请系统。
